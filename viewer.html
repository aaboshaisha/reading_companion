<!DOCTYPE html>
<html>
    <head>
        <title>Viewer</title>
        <!-- the core library that parses the pdf -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    </head>
    <body>
        <div>
            <button id='prev'>Previous</button>
            <span>Page:
                <span id='page-num'></span> / <span id='page-count'></span>
            </span>
            <button id='next'>Next</button>
        </div>
        <canvas id='pdf-canvas'></canvas>

        <script>
            // the worker runs heavy processing in separate thread (to keep page responsive)
            // tell pdfjs where worker file is
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

            const url = 'sample.pdf';
            let doc = null;
            let pnum = 1;

            async function loadPDF() {
                doc = await pdfjsLib.getDocument(url).promise;
                console.log('pdf loaded!!!');
                await renderPage(1);
            }

            async function renderPage(num) {
                // disable buttons while rendering
                document.getElementById('prev').disabled = true;
                document.getElementById('next').disabled = true;
                
                const page = await doc.getPage(num);
                const canvas = document.getElementById('pdf-canvas');
                // context is our toolkit - we give it instructions to draw
                const ctx = canvas.getContext('2d')
                // get page dims and make it 1.5x bigger 
                const viewport = page.getViewport({scale: 1.5});
                // set canvas size to match it
                canvas.height=viewport.height; canvas.width=viewport.width;
                // render the page.. ctx (toolkit to draw) and viewport(what size)
                await page.render({canvasContext:ctx, viewport:viewport}).promise;

                // enable them when done
                document.getElementById('prev').disabled = false;
                document.getElementById('next').disabled = false;

            }

            // add click handler to buttons
            document.getElementById('next').addEventListener('click', function() {
                if (pnum < doc.numPages) {
                    pnum = pnum + 1;
                    renderPage(pnum);
                }

            });

            document.getElementById('prev').addEventListener('click', function (){
                if (pnum > 1){
                    pnum = pnum - 1;
                    renderPage(pnum);        
                }

            })



            loadPDF();

        </script>
    </body>
</html>